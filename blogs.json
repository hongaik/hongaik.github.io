{"status":"ok","feed":{"url":"https://medium.com/feed/@goh-hongaik","title":"Stories by Goh Hong Aik on Medium","link":"https://medium.com/@goh-hongaik?source=rss-8083336601c0------2","author":"","description":"Stories by Goh Hong Aik on Medium","image":"https://cdn-images-1.medium.com/fit/c/150/150/0*4zhNdxE5NDwp1xZj"},"items":[{"title":"Combining Supervised and Unsupervised Learning in Topic Modelling","pubDate":"2022-03-19 10:28:31","link":"https://goh-hongaik.medium.com/combining-supervised-and-unsupervised-learning-in-topic-modelling-6034f5743881?source=rss-8083336601c0------2","guid":"https://medium.com/p/6034f5743881","author":"Goh Hong Aik","thumbnail":"https://cdn-images-1.medium.com/max/1024/0*QpCTfuzBud7BIeBl","description":"\n<h3><strong>Pipeline for Semi-Supervised Learning in Topic Modelling</strong></h3>\n<h4><em>A useful technique when you have a lot of text and no\u00a0labels</em></h4>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/1024/0*QpCTfuzBud7BIeBl\"><figcaption>Photo by <a href=\"https://unsplash.com/@wesleyphotography?utm_source=medium&amp;utm_medium=referral\">Wesley Tingey</a> on\u00a0<a href=\"https://unsplash.com/?utm_source=medium&amp;utm_medium=referral\">Unsplash</a></figcaption></figure><p><strong>Introduction</strong></p>\n<p>Suppose you are part of a team that just launched a new product, or you are tasked with monitoring service feedback. How do you quickly understand what your customers like or dislike about you product/service amidst the mountains of reviews? While traditional topic modelling techniques such as Latent Dirichlet Allocation (LDA) and Non-negative Matrix Factorization (NMF) can help, there is limited scope for fine-tuning. This article will describe a pipeline amalgamating various Natural Language Processing (NLP) techniques to perform text classification. The advantages of this method\u00a0include:</p>\n<ul>\n<li>Suitable for multi-label classification</li>\n<li>Minimal manual labelling</li>\n<li>Many options for experimenting and fine-tuning</li>\n</ul>\n<p>Topic modelling is a field within NLP which seeks to find broad topics that occur within a corpus of text. With this, a large amount of text can be quickly categorised. Typical techniques such as LDA and NMF work by employing statistical techniques to determine which words are closely associated and require the user to input a pre-specified number of topics that he/she expects to be present, and the output is the probability that each document belongs to the topic. While the models do not inherently understand the topics, it can output top words associated with each topic and allow the user to make a judgment about what the topic is about. An example could look like\u00a0this:</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/760/1*KhrHZaaVdSyKip30kEAGtQ.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p>The user would then classify the first text under Topic 1, and the second text under Topic 2. While this is great for a quick and broad overview, there is very limited scope for fine-tuning for better accuracy. My personal observation from initial tries with LDA and NMF is that <a href=\"https://nlp.stanford.edu/pubs/llda-emnlp09.pdf\">these do not do very well in multi-label classification</a>.</p>\n<p><strong>Data</strong></p>\n<p>The pipeline can be applied on any corpus of text; in my case I used data obtained from a private enterprise that I was helping out. Sample documents:</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/1024/1*RIVdVdxfDZuc1uC-wO4c1g.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p><strong>Pipeline Overview</strong></p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/721/1*iLeGYECwVQSt7p0E-9rbjw.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p>The crux of the pipeline lies with the second stage, where a small subset of hand labelled data is responsible for guiding downstream modelling.</p>\n<p><strong>1. Identify topics with\u00a0BerTopic</strong></p>\n<p><a href=\"https://github.com/MaartenGr/BERTopic\">BerTopic</a> is an unsupervised topic modelling technique that leverages transformers and c-TF-IDF to create dense clusters allowing for easily interpretable topics whilst keeping important words in the topic descriptions.</p>\n<p>Unlike LDA and NMF which use statistical methods, BerTopic uses BERT (or any other language model) to deduce the \u201cmeaning\u201d of the text via sentence embeddings. Pre-determining the number of topics is also optional. However, due to its stochastic nature, the results are generally not reproducible (though the variability is low). Furthermore, it also does not do very well in multi-label classification.</p>\n<a href=\"https://medium.com/media/1f17ab7c490847324723a3b3ae6ee7ae/href\">https://medium.com/media/1f17ab7c490847324723a3b3ae6ee7ae/href</a><p>Output:</p>\n<pre>Topic -1<br>['customers', 'product', 'technician', 'professional', 'questions', 'solutions', 'contact', 'maintenance', 'customer service', 'store']<br><br><br>Topic 0<br>['solved problem', 'problem solved', 'zoomskype problem', 'friendly helpers', 'friendly helps', 'friendly helping', 'friendly helpful', 'friendly helped', 'friendly help', 'friendly maintenance']<br><br><br>Topic 1<br>['service good', 'good service', 'service happy', 'friendly helpers', 'friendly information', 'friendly importantly', 'friendly engaging', 'friendly human', 'friendly hospitable', 'friendly highly']<br><br><br>Topic 2<br>['simple', 'friendly helping', 'friendly helpful', 'friendly helpers', 'friendly helped', 'friendly help', 'friendly guide', 'friendly helps', 'friendly highly', 'friendly layout']<br><br><br>Topic 3<br>['service good', 'good service', 'servive', 'good servive', 'servive good', 'friendly hospitable', 'friendly highly', 'friendly helpful', 'friendly helpers', 'friendly great']</pre>\n<p>Here, BerTopic produced 145 topics (Topic -1 represents outliers) and we can see the top words associated with each topic. Unfortunately, some manual effort is required here to condense the number of topics. Here, I\u2019ve condensed the number of topics down to\u00a07.</p>\n<p><strong>2. Manually label a small subset of the\u00a0corpus</strong></p>\n<p>Next, a small subset of the corpus has to be manually labelled. I ensured that each topic (derived from the output of BerTopic) had at least 10 documents. In total, I labelled about 200 records. This one time effort will be used for downstream model training, hence it needs to be prepared with care. It cannot be avoided, especially if you want to have a sense of how well your model is performing.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/535/1*qV-EBwdTLQcO0Fsq4pfyTw.jpeg\"><figcaption>Topic distribution in the manually labelled dataset (Image by\u00a0Author)</figcaption></figure><p><strong>3. Generate synthetic training data with backtranslation</strong></p>\n<p>With the manually labelled data, we are now ready to create new data. The process is analogous to that used in image classification, where transformations can be applied to existing images to generate new images. The <a href=\"https://github.com/makcedward/nlpaug\">nlpaug</a> library provides a diverse range of techniques to alter data to create new text, and is even able to simulate spelling\u00a0errors.</p>\n<p>Backtranslation is one of the techniques and it involves translating a given text into another language and then back to English, which in the process changes the choice of words used (see this hilarious <a href=\"https://www.youtube.com/watch?v=2bVAoVlFYf0\">example</a> of Frozen\u2019s Let It Go). It was selected after testing a variety of techniques as it is a \u201csoft\u201d way of altering text. Some other methods might create entirely new sentences with wildly differing meanings which may not be ideal. However, the downside of backtranslation is that the alterations can be quite subtle and this inevitably \u201cleaks\u201d information during model training. To increase alterations, translated languages should be as different from English as possible, such as Japanese, Mandarin and\u00a0German.</p>\n<a href=\"https://medium.com/media/eb4a56bb6059b8cb148ede79c49aa865/href\">https://medium.com/media/eb4a56bb6059b8cb148ede79c49aa865/href</a><p>Output:</p>\n<pre>['The language your partner uses is very straightforward, polite, and difficult to grasp. The connection is smooth.',<br> 'The language used between my partner is very friendly, polite yet easy to understand, and communication is smooth.',<br> 'The language used by the partner is very friendly, polite and easy to understand, and communication is smooth.']</pre>\n<p>After augmentation (this process may take several hours depending on the volume), we have about 3,000 rows of training\u00a0data.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/540/1*rVnS11ghm-aymmHGPA3uZg.jpeg\"><figcaption>Topic distribution in augmented dataset (Image by\u00a0Author)</figcaption></figure><p><strong>Baseline Model</strong></p>\n<p>As the field of NLP advances over the years, new tools have emerged to help us with various NLP tasks, and one such is Zero Shot Classification (ZSC) from <a href=\"https://huggingface.co/facebook/bart-large-mnli\">HuggingFace</a>, where one can input the target text and list of topics and generate probabilities that the text belongs to each\u00a0topic.</p>\n<a href=\"https://medium.com/media/83be3bf0ddb8eec26d3d10de83ebe1f2/href\">https://medium.com/media/83be3bf0ddb8eec26d3d10de83ebe1f2/href</a><p>Output:</p>\n<pre>{'sequence': '\\nThe language used by partners is very friendly and polite and easy to understand, the connection is also smooth\\n',<br> 'labels': ['communication',<br>  'information',<br>  'facilities',<br>  'user interface',<br>  'location',<br>  'price',<br>  'waiting time'],<br> 'scores': [0.9803360104560852,<br>  0.7030088901519775,<br>  0.6719058156013489,<br>  0.6212607622146606,<br>  0.3871709108352661,<br>  0.33242109417915344,<br>  0.13848033547401428]}</pre>\n<p>In ZSC, the class names have to be carefully chosen as words can mean very different things to humans versus the language model. Unfortunately, as powerful and simple as the technique is, the weighted F1-score is only 54% when evaluated on the test\u00a0set.</p>\n<p><strong>4. Train a model with the synthetic data</strong></p>\n<p>At this point, the task is simply a supervised multi-label classification problem. Although various classifiers were tested, Support Vector Classifiers (SVCs) have consistently outperformed the rest, hence it was adopted as the default classifier.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/762/1*7AB5UpK-N4BqCUa6d4RyOQ.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p>We can see that Expts 1, 3 and 5 produce very similar\u00a0results.</p>\n<p><strong>Further Evaluation</strong></p>\n<p>As the test set is relatively small and information would have leaked from the training set to the test set during the data augmentation process, further evaluation of the models has to be done. One way is to further label more data as a holdout set which has not been augmented in any\u00a0way.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/758/1*EHsSWznSDo_9YA5jznLOUg.png\"><figcaption>Image by\u00a0Author</figcaption></figure><figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/513/1*L3S9ifazcrM4_j75Pkmglg.jpeg\"><figcaption>Classification report for Word2Vec (Image by\u00a0Author)</figcaption></figure><p>We see that model performance has dipped significantly in the holdout set, although Word2Vec still remains the best. Some topics such as \u201clocation\u201d and \u201cfacilities\u201d are also harder for the model to pick up possibly due to the vague nature of the texts. This way of evaluation may not necessarily be reflective as a small holdout set would result in large swings in percentages should a few predictions be off. Furthermore, language is subjective in nature and even two people can have differences in how a given text should be labelled. It is thus imperative to devise your own way to validate the model\u2019s performance.</p>\n<p>In my context, I decided to inspect the category \u201cOthers\u201d, which consists of text that the models have deemed to fit in none of the topics. While there are legitimate texts which should reside in \u201cOthers\u201d, most of the time they should fall in at least 1 topic, especially when the text is long. This means that the quality of predictions in this category could give us an intuition of whether the model is able to interpret the text. I thus decided to inspect the longest 5 texts each from Expts 1, 3 and 5 which have been classified as \u201cOthers\u201d (Green highlights indicate what I felt should be the correct classification. and I was also ready to accept a reasonable variation of answers eg. Some topics were secondary and may not have been the main point, but I would accept even if the model had not picked it\u00a0up).</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/801/1*lGfKdj1McHSvq7mSTzAJIg.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p>We can observe that the tuned BERT model is not doing as well as originally thought, although the F1 score on the test set was over 90%. This is ironic given that the language model has been tuned toward the context, but it could also have been over-tuned. Together with further random validation checks, I am convinced that the Word2Vec model is the best and has satisfactorily classified my\u00a0texts.</p>\n<p><strong>Sentiment Analysis</strong></p>\n<p>While it\u2019s important to know what customers like and dislike about our service or product, higher emphasis is usually placed on negative reviews. To further distinguish between positive and negative reviews, I used <a href=\"https://huggingface.co/models\">HuggingFace\u2019s transformer models</a> to label my documents.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/762/1*VE17tkLqAM5sAEz3NKsgQw.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/433/1*B3Sv2fx4fV1zJXa9sr-BgA.jpeg\"><figcaption>Confusion Matrix of bart-large-mnli (Image by\u00a0Author)</figcaption></figure><p>Though bart-large-mnli is typically used for text classification, it performs surprisingly well for sentiment analysis\u00a0tasks.</p>\n<a href=\"https://medium.com/media/802887dcd5738773a7ef65085b55c849/href\">https://medium.com/media/802887dcd5738773a7ef65085b55c849/href</a><p>Output:</p>\n<pre>{'sequence': 'The price is $50',<br> 'labels': ['positive', 'negative'],<br> 'scores': [0.5607846975326538, 0.4392153024673462]}</pre>\n<p>Here, I chose bart-large-mnli over the distilbert-base-uncased because I wanted to minimise false negatives ie. I wanted my negative reviews to be clean, at the expense of missing out on\u00a0some.</p>\n<p><strong>Final Deliverable</strong></p>\n<p>To help stakeholders quickly understand the data as well as provide flexibility to obtain different cuts, I created a simple interactive Tableau dashboard to aid data exploration.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/1024/1*m0RpKqdeKIjXtFfXczGiig.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p>You can also play around with a simple <a href=\"https://huggingface.co/spaces/hongaik/service_text_classification/\">app</a> I deployed on HuggingFace!</p>\n<p><strong>Conclusion</strong></p>\n<p>Even with the advance of NLP techniques, topic modelling is notoriously difficult to have a good sense of the accuracy without having sufficient labelled data. With this pipeline, despite some of its inherent flaws (eg. data leakage) I could train up a decent model to perform classification with only a small amount of labelled data. In other words, small efforts for disproportionately large gains. The pipeline also provides much whitespace to experiment and fine-tune to the domain problem in the data augmentation and model training phases, which is typically not possible in unsupervised learning problems.</p>\n<p><strong>Future Work</strong></p>\n<p>I hope to be able to test my pipeline on another labelled dataset with multi-labels for further validation, as I wasn\u2019t able to given the tight project timeline.</p>\n<p>Do let me know if this has helped\u00a0you!</p>\n<p><a href=\"https://www.linkedin.com/in/hongaikgoh/\">LinkedIn</a> | <a href=\"http://goh.hongaik@gmail.com/\">Email</a> | <a href=\"https://github.com/hongaik/Customer_Feedback_Topic_Modelling\">GitHub Code</a> | <a href=\"https://huggingface.co/spaces/hongaik/service_text_classification/\">Play Around With The\u00a0Model</a></p>\n<img src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=6034f5743881\" width=\"1\" height=\"1\" alt=\"\">\n","content":"\n<h3><strong>Pipeline for Semi-Supervised Learning in Topic Modelling</strong></h3>\n<h4><em>A useful technique when you have a lot of text and no\u00a0labels</em></h4>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/1024/0*QpCTfuzBud7BIeBl\"><figcaption>Photo by <a href=\"https://unsplash.com/@wesleyphotography?utm_source=medium&amp;utm_medium=referral\">Wesley Tingey</a> on\u00a0<a href=\"https://unsplash.com/?utm_source=medium&amp;utm_medium=referral\">Unsplash</a></figcaption></figure><p><strong>Introduction</strong></p>\n<p>Suppose you are part of a team that just launched a new product, or you are tasked with monitoring service feedback. How do you quickly understand what your customers like or dislike about you product/service amidst the mountains of reviews? While traditional topic modelling techniques such as Latent Dirichlet Allocation (LDA) and Non-negative Matrix Factorization (NMF) can help, there is limited scope for fine-tuning. This article will describe a pipeline amalgamating various Natural Language Processing (NLP) techniques to perform text classification. The advantages of this method\u00a0include:</p>\n<ul>\n<li>Suitable for multi-label classification</li>\n<li>Minimal manual labelling</li>\n<li>Many options for experimenting and fine-tuning</li>\n</ul>\n<p>Topic modelling is a field within NLP which seeks to find broad topics that occur within a corpus of text. With this, a large amount of text can be quickly categorised. Typical techniques such as LDA and NMF work by employing statistical techniques to determine which words are closely associated and require the user to input a pre-specified number of topics that he/she expects to be present, and the output is the probability that each document belongs to the topic. While the models do not inherently understand the topics, it can output top words associated with each topic and allow the user to make a judgment about what the topic is about. An example could look like\u00a0this:</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/760/1*KhrHZaaVdSyKip30kEAGtQ.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p>The user would then classify the first text under Topic 1, and the second text under Topic 2. While this is great for a quick and broad overview, there is very limited scope for fine-tuning for better accuracy. My personal observation from initial tries with LDA and NMF is that <a href=\"https://nlp.stanford.edu/pubs/llda-emnlp09.pdf\">these do not do very well in multi-label classification</a>.</p>\n<p><strong>Data</strong></p>\n<p>The pipeline can be applied on any corpus of text; in my case I used data obtained from a private enterprise that I was helping out. Sample documents:</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/1024/1*RIVdVdxfDZuc1uC-wO4c1g.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p><strong>Pipeline Overview</strong></p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/721/1*iLeGYECwVQSt7p0E-9rbjw.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p>The crux of the pipeline lies with the second stage, where a small subset of hand labelled data is responsible for guiding downstream modelling.</p>\n<p><strong>1. Identify topics with\u00a0BerTopic</strong></p>\n<p><a href=\"https://github.com/MaartenGr/BERTopic\">BerTopic</a> is an unsupervised topic modelling technique that leverages transformers and c-TF-IDF to create dense clusters allowing for easily interpretable topics whilst keeping important words in the topic descriptions.</p>\n<p>Unlike LDA and NMF which use statistical methods, BerTopic uses BERT (or any other language model) to deduce the \u201cmeaning\u201d of the text via sentence embeddings. Pre-determining the number of topics is also optional. However, due to its stochastic nature, the results are generally not reproducible (though the variability is low). Furthermore, it also does not do very well in multi-label classification.</p>\n<a href=\"https://medium.com/media/1f17ab7c490847324723a3b3ae6ee7ae/href\">https://medium.com/media/1f17ab7c490847324723a3b3ae6ee7ae/href</a><p>Output:</p>\n<pre>Topic -1<br>['customers', 'product', 'technician', 'professional', 'questions', 'solutions', 'contact', 'maintenance', 'customer service', 'store']<br><br><br>Topic 0<br>['solved problem', 'problem solved', 'zoomskype problem', 'friendly helpers', 'friendly helps', 'friendly helping', 'friendly helpful', 'friendly helped', 'friendly help', 'friendly maintenance']<br><br><br>Topic 1<br>['service good', 'good service', 'service happy', 'friendly helpers', 'friendly information', 'friendly importantly', 'friendly engaging', 'friendly human', 'friendly hospitable', 'friendly highly']<br><br><br>Topic 2<br>['simple', 'friendly helping', 'friendly helpful', 'friendly helpers', 'friendly helped', 'friendly help', 'friendly guide', 'friendly helps', 'friendly highly', 'friendly layout']<br><br><br>Topic 3<br>['service good', 'good service', 'servive', 'good servive', 'servive good', 'friendly hospitable', 'friendly highly', 'friendly helpful', 'friendly helpers', 'friendly great']</pre>\n<p>Here, BerTopic produced 145 topics (Topic -1 represents outliers) and we can see the top words associated with each topic. Unfortunately, some manual effort is required here to condense the number of topics. Here, I\u2019ve condensed the number of topics down to\u00a07.</p>\n<p><strong>2. Manually label a small subset of the\u00a0corpus</strong></p>\n<p>Next, a small subset of the corpus has to be manually labelled. I ensured that each topic (derived from the output of BerTopic) had at least 10 documents. In total, I labelled about 200 records. This one time effort will be used for downstream model training, hence it needs to be prepared with care. It cannot be avoided, especially if you want to have a sense of how well your model is performing.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/535/1*qV-EBwdTLQcO0Fsq4pfyTw.jpeg\"><figcaption>Topic distribution in the manually labelled dataset (Image by\u00a0Author)</figcaption></figure><p><strong>3. Generate synthetic training data with backtranslation</strong></p>\n<p>With the manually labelled data, we are now ready to create new data. The process is analogous to that used in image classification, where transformations can be applied to existing images to generate new images. The <a href=\"https://github.com/makcedward/nlpaug\">nlpaug</a> library provides a diverse range of techniques to alter data to create new text, and is even able to simulate spelling\u00a0errors.</p>\n<p>Backtranslation is one of the techniques and it involves translating a given text into another language and then back to English, which in the process changes the choice of words used (see this hilarious <a href=\"https://www.youtube.com/watch?v=2bVAoVlFYf0\">example</a> of Frozen\u2019s Let It Go). It was selected after testing a variety of techniques as it is a \u201csoft\u201d way of altering text. Some other methods might create entirely new sentences with wildly differing meanings which may not be ideal. However, the downside of backtranslation is that the alterations can be quite subtle and this inevitably \u201cleaks\u201d information during model training. To increase alterations, translated languages should be as different from English as possible, such as Japanese, Mandarin and\u00a0German.</p>\n<a href=\"https://medium.com/media/eb4a56bb6059b8cb148ede79c49aa865/href\">https://medium.com/media/eb4a56bb6059b8cb148ede79c49aa865/href</a><p>Output:</p>\n<pre>['The language your partner uses is very straightforward, polite, and difficult to grasp. The connection is smooth.',<br> 'The language used between my partner is very friendly, polite yet easy to understand, and communication is smooth.',<br> 'The language used by the partner is very friendly, polite and easy to understand, and communication is smooth.']</pre>\n<p>After augmentation (this process may take several hours depending on the volume), we have about 3,000 rows of training\u00a0data.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/540/1*rVnS11ghm-aymmHGPA3uZg.jpeg\"><figcaption>Topic distribution in augmented dataset (Image by\u00a0Author)</figcaption></figure><p><strong>Baseline Model</strong></p>\n<p>As the field of NLP advances over the years, new tools have emerged to help us with various NLP tasks, and one such is Zero Shot Classification (ZSC) from <a href=\"https://huggingface.co/facebook/bart-large-mnli\">HuggingFace</a>, where one can input the target text and list of topics and generate probabilities that the text belongs to each\u00a0topic.</p>\n<a href=\"https://medium.com/media/83be3bf0ddb8eec26d3d10de83ebe1f2/href\">https://medium.com/media/83be3bf0ddb8eec26d3d10de83ebe1f2/href</a><p>Output:</p>\n<pre>{'sequence': '\\nThe language used by partners is very friendly and polite and easy to understand, the connection is also smooth\\n',<br> 'labels': ['communication',<br>  'information',<br>  'facilities',<br>  'user interface',<br>  'location',<br>  'price',<br>  'waiting time'],<br> 'scores': [0.9803360104560852,<br>  0.7030088901519775,<br>  0.6719058156013489,<br>  0.6212607622146606,<br>  0.3871709108352661,<br>  0.33242109417915344,<br>  0.13848033547401428]}</pre>\n<p>In ZSC, the class names have to be carefully chosen as words can mean very different things to humans versus the language model. Unfortunately, as powerful and simple as the technique is, the weighted F1-score is only 54% when evaluated on the test\u00a0set.</p>\n<p><strong>4. Train a model with the synthetic data</strong></p>\n<p>At this point, the task is simply a supervised multi-label classification problem. Although various classifiers were tested, Support Vector Classifiers (SVCs) have consistently outperformed the rest, hence it was adopted as the default classifier.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/762/1*7AB5UpK-N4BqCUa6d4RyOQ.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p>We can see that Expts 1, 3 and 5 produce very similar\u00a0results.</p>\n<p><strong>Further Evaluation</strong></p>\n<p>As the test set is relatively small and information would have leaked from the training set to the test set during the data augmentation process, further evaluation of the models has to be done. One way is to further label more data as a holdout set which has not been augmented in any\u00a0way.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/758/1*EHsSWznSDo_9YA5jznLOUg.png\"><figcaption>Image by\u00a0Author</figcaption></figure><figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/513/1*L3S9ifazcrM4_j75Pkmglg.jpeg\"><figcaption>Classification report for Word2Vec (Image by\u00a0Author)</figcaption></figure><p>We see that model performance has dipped significantly in the holdout set, although Word2Vec still remains the best. Some topics such as \u201clocation\u201d and \u201cfacilities\u201d are also harder for the model to pick up possibly due to the vague nature of the texts. This way of evaluation may not necessarily be reflective as a small holdout set would result in large swings in percentages should a few predictions be off. Furthermore, language is subjective in nature and even two people can have differences in how a given text should be labelled. It is thus imperative to devise your own way to validate the model\u2019s performance.</p>\n<p>In my context, I decided to inspect the category \u201cOthers\u201d, which consists of text that the models have deemed to fit in none of the topics. While there are legitimate texts which should reside in \u201cOthers\u201d, most of the time they should fall in at least 1 topic, especially when the text is long. This means that the quality of predictions in this category could give us an intuition of whether the model is able to interpret the text. I thus decided to inspect the longest 5 texts each from Expts 1, 3 and 5 which have been classified as \u201cOthers\u201d (Green highlights indicate what I felt should be the correct classification. and I was also ready to accept a reasonable variation of answers eg. Some topics were secondary and may not have been the main point, but I would accept even if the model had not picked it\u00a0up).</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/801/1*lGfKdj1McHSvq7mSTzAJIg.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p>We can observe that the tuned BERT model is not doing as well as originally thought, although the F1 score on the test set was over 90%. This is ironic given that the language model has been tuned toward the context, but it could also have been over-tuned. Together with further random validation checks, I am convinced that the Word2Vec model is the best and has satisfactorily classified my\u00a0texts.</p>\n<p><strong>Sentiment Analysis</strong></p>\n<p>While it\u2019s important to know what customers like and dislike about our service or product, higher emphasis is usually placed on negative reviews. To further distinguish between positive and negative reviews, I used <a href=\"https://huggingface.co/models\">HuggingFace\u2019s transformer models</a> to label my documents.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/762/1*VE17tkLqAM5sAEz3NKsgQw.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/433/1*B3Sv2fx4fV1zJXa9sr-BgA.jpeg\"><figcaption>Confusion Matrix of bart-large-mnli (Image by\u00a0Author)</figcaption></figure><p>Though bart-large-mnli is typically used for text classification, it performs surprisingly well for sentiment analysis\u00a0tasks.</p>\n<a href=\"https://medium.com/media/802887dcd5738773a7ef65085b55c849/href\">https://medium.com/media/802887dcd5738773a7ef65085b55c849/href</a><p>Output:</p>\n<pre>{'sequence': 'The price is $50',<br> 'labels': ['positive', 'negative'],<br> 'scores': [0.5607846975326538, 0.4392153024673462]}</pre>\n<p>Here, I chose bart-large-mnli over the distilbert-base-uncased because I wanted to minimise false negatives ie. I wanted my negative reviews to be clean, at the expense of missing out on\u00a0some.</p>\n<p><strong>Final Deliverable</strong></p>\n<p>To help stakeholders quickly understand the data as well as provide flexibility to obtain different cuts, I created a simple interactive Tableau dashboard to aid data exploration.</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/1024/1*m0RpKqdeKIjXtFfXczGiig.jpeg\"><figcaption>Image by\u00a0Author</figcaption></figure><p>You can also play around with a simple <a href=\"https://huggingface.co/spaces/hongaik/service_text_classification/\">app</a> I deployed on HuggingFace!</p>\n<p><strong>Conclusion</strong></p>\n<p>Even with the advance of NLP techniques, topic modelling is notoriously difficult to have a good sense of the accuracy without having sufficient labelled data. With this pipeline, despite some of its inherent flaws (eg. data leakage) I could train up a decent model to perform classification with only a small amount of labelled data. In other words, small efforts for disproportionately large gains. The pipeline also provides much whitespace to experiment and fine-tune to the domain problem in the data augmentation and model training phases, which is typically not possible in unsupervised learning problems.</p>\n<p><strong>Future Work</strong></p>\n<p>I hope to be able to test my pipeline on another labelled dataset with multi-labels for further validation, as I wasn\u2019t able to given the tight project timeline.</p>\n<p>Do let me know if this has helped\u00a0you!</p>\n<p><a href=\"https://www.linkedin.com/in/hongaikgoh/\">LinkedIn</a> | <a href=\"http://goh.hongaik@gmail.com/\">Email</a> | <a href=\"https://github.com/hongaik/Customer_Feedback_Topic_Modelling\">GitHub Code</a> | <a href=\"https://huggingface.co/spaces/hongaik/service_text_classification/\">Play Around With The\u00a0Model</a></p>\n<img src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=6034f5743881\" width=\"1\" height=\"1\" alt=\"\">\n","enclosure":{},"categories":["semi-supervised-learning","topic-modeling"]}]}